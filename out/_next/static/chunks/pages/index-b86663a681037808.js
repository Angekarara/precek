(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{38593:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getApiKeys:()=>I,getTypeColorMui:()=>h,readPdfFile:()=>y,readTextFile:()=>v,truncateText:()=>g});var n=r(70236),a=r(63857),o=r(43081),s=r.n(o),i=r(57845),c=r.n(i),l=r(65364),u=/^%PDF-\d\.\d/,d=/%%EOF[\x0D\x0A]?$/,p=null;try{Promise.all([r.e(233),r.e(909)]).then(r.bind(r,53553)).then(function(e){(p=e).GlobalWorkerOptions.workerSrc="//unpkg.com/pdfjs-dist@5.1.91/build/pdf.worker.min.mjs",console.log("PDF.js loaded and worker set.")}).catch(function(e){console.error("Failed to load PDF.js:",e),p=null})}catch(e){console.error("Error setting up PDF.js:",e),p=null}var f=null,x=!1,m=function(){var e=(0,a.A)(s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(f||x)){e.next=7;break}case 1:if(!x){e.next=6;break}return e.next=4,new Promise(function(e){return setTimeout(e,100)});case 4:e.next=1;break;case 6:return e.abrupt("return",f);case 7:return x=!0,console.log("Initializing Tesseract worker..."),e.prev=9,e.next=12,c().createWorker("eng",1,{});case 12:return f=t=e.sent,console.log("Tesseract worker initialized."),e.abrupt("return",t);case 18:throw e.prev=18,e.t0=e.catch(9),console.error("Failed to initialize Tesseract worker:",e.t0),f=null,Error("Could not initialize Tesseract OCR.");case 23:return e.prev=23,x=!1,e.finish(23);case 26:case"end":return e.stop()}},e,null,[[9,18,23,26]])}));return function(){return e.apply(this,arguments)}}();function g(e,t){return e?e.length>t?e.substring(0,t)+"...":e:""}function h(e){switch(e){case"text":return"primary.main";case"image":return"success.main";case"audio":return"warning.main";case"video":return"secondary.main";default:return"grey.500"}}var v=function(e){return new Promise(function(t,r){var n=new FileReader;n.onload=function(e){return t(e.target.result)},n.onerror=function(e){return r(Error("Error reading text file"))},n.readAsText(e)})},y=function(){var e=(0,a.A)(s().mark(function e(t){var r,n,a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return e.next=4,b(t);case 4:if(e.sent){e.next=6;break}throw Error("Invalid or corrupted PDF file");case 6:return e.prev=6,e.next=9,t.arrayBuffer();case 9:return n=e.sent,e.next=12,A(n);case 12:if(a=e.sent,o="","text"!==a){e.next=20;break}return e.next=17,k(n);case 17:o=e.sent,e.next=26;break;case 20:return e.next=22,m();case 22:return r=e.sent,e.next=25,w(n,r);case 25:o=e.sent;case 26:return e.abrupt("return",j(o));case 29:throw e.prev=29,e.t0=e.catch(6),console.error("PDF processing failed:",e.t0),Error("PDF processing error: ".concat(e.t0.message));case 33:if(e.prev=33,!r){e.next=42;break}return e.prev=35,e.next=38,r.terminate();case 38:e.next=42;break;case 40:e.prev=40,e.t1=e.catch(35);case 42:return e.finish(33);case 43:case"end":return e.stop()}},e,null,[[6,29,33,43],[35,40]])}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.A)(s().mark(function e(t){var r,a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.arrayBuffer();case 3:return r=new Uint8Array(e.sent),a=String.fromCharCode.apply(String,(0,n.A)(r.subarray(0,4))),o=String.fromCharCode.apply(String,(0,n.A)(r.subarray(-4))),e.abrupt("return",u.test(a)&&d.test(o));case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,a.A)(s().mark(function e(t){var r,n,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getDocument({data:t}).promise;case 2:return r=e.sent,e.next=5,r.getPage(1);case 5:return n=e.sent,e.next=8,n.getTextContent();case 8:return a=e.sent,n.cleanup(),e.abrupt("return",a.items.length>5?"text":"image");case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,a.A)(s().mark(function e(t){var r,n,a,o,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getDocument({data:t}).promise;case 2:r=e.sent,n="",a=1;case 5:if(!(a<=r.numPages)){e.next=17;break}return e.next=8,r.getPage(a);case 8:return o=e.sent,e.next=11,o.getTextContent();case 11:i=e.sent,n+=i.items.map(function(e){return e.str}).join(" ")+"\n\n",o.cleanup();case 14:a++,e.next=5;break;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.A)(s().mark(function e(t,r){var n,a,o,i,c,l,u,d;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getDocument({data:t}).promise;case 2:n=e.sent,o=(a=document.createElement("canvas")).getContext("2d"),i="",c=1;case 7:if(!(c<=n.numPages)){e.next=25;break}return e.next=10,n.getPage(c);case 10:return u=(l=e.sent).getViewport({scale:2}),a.width=u.width,a.height=u.height,e.next=16,l.render({canvasContext:o,viewport:u}).promise;case 16:return e.next=18,r.recognize(a);case 18:d=e.sent.data.text,i+=d+"\n\n",l.cleanup();case 22:c++,e.next=7;break;case 25:return a.remove(),e.abrupt("return",i);case 27:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),j=function(e){return e.replace(/(\w+-\n\w+)/g,function(e){return e.replace(/-\n/g,"")}).replace(/[\x00-\x1F\x7F-\x9F]/g,"").replace(/\s+/g," ").replace(/[“”]/g,'"').replace(/[‘’]/g,"'").replace(/(\s\w\s)/g," ").trim().replace(/\n{3,}/g,"\n\n")},I=function(){var e="",t=l.env.NEXT_PUBLIC_OPENROUTER_API_KEY||"",r=l.env.NEXT_PUBLIC_OPENAI_API_KEY||"";return window.__PRECEK_API_KEYS&&window.__PRECEK_API_KEYS.openai&&(e=window.__PRECEK_API_KEYS.openai),e||(e=localStorage.getItem("openai_api_key")||""),e||(e=r),{openai:e,openrouter:t}}},42936:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(44134)}])},44134:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>G});var n=r(63857),a=r(43081),o=r.n(a),s=r(14232);r(77328);var i=r(48230),c=r.n(i),l=r(38593),u=r(15654),d=r(53114),p=r(18068),f=r(57186);function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var g=function(){var e=(0,n.A)(o().mark(function e(t){var r,n,a=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:"text input",a.length>2&&a[2],console.log("Storing text from: ".concat(r)),e.prev=3,n=t,e.next=7,(0,u.ys)({type:"text",source:r,content:t,processingResult:n,timestamp:new Date().toISOString()});case 7:return console.log("Text stored successfully: ".concat(r)),e.abrupt("return",{success:!0,processingResult:n});case 11:return e.prev=11,e.t0=e.catch(3),console.error("Error storing text from ".concat(r,":"),e.t0),e.abrupt("return",{error:!0,processingResult:"Error: ".concat(e.t0.message||"Unable to store text.")});case 15:case"end":return e.stop()}},e,null,[[3,11]])}));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=(0,n.A)(o().mark(function e(t){var r,n,a,s,i,c,l,d,p,f,x,m=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m.length>1&&void 0!==m[1]?m[1]:"image file",n=m.length>2?m[2]:void 0,console.log("Processing image: ".concat(r," using OpenRouter Gemini Flash")),a=null==n?void 0:n.openrouter){e.next=7;break}return console.error("Error processing image: OpenRouter API key is required."),e.abrupt("return",{error:!0,processingResult:"OpenRouter API key for image processing is required."});case 7:return e.prev=7,e.next=10,new Promise(function(e,r){var n=new FileReader;n.onload=function(){var t;return e(null==(t=n.result)?void 0:t.toString().split(",")[1])},n.onerror=function(e){return r(e)},n.readAsDataURL(t)});case 10:if(i=e.sent){e.next=13;break}throw Error("Failed to read image file as base64.");case 13:return c={Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},l=JSON.stringify({model:"google/gemini-2.0-flash-thinking-exp:free",messages:[{role:"user",content:[{type:"text",text:"Describe this image and identify any key objects or themes."},{type:"image_url",image_url:{url:"data:".concat(t.type,";base64,").concat(i)}}]}],max_tokens:300}),e.next=18,fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:c,body:l});case 18:if((d=e.sent).ok){e.next=27;break}return e.next=22,d.json().catch(function(){return{}});case 22:if(f=e.sent,console.error("OpenRouter API Error (".concat(d.status,"):"),f),401!==d.status){e.next=26;break}throw Error("OpenRouter API key is invalid or unauthorized (401)");case 26:throw Error("OpenRouter API request failed with status ".concat(d.status,": ").concat((null==(p=f.error)?void 0:p.message)||d.statusText));case 27:return e.next=29,d.json();case 29:return x=(null==(s=e.sent.choices[0])||null==(s=s.message)?void 0:s.content)||"No result from API",e.next=33,(0,u.ys)({type:"image",source:r,content:"Image file: ".concat(t.name),processingResult:x,timestamp:new Date().toISOString()});case 33:return console.log("Image processed successfully: ".concat(r)),e.abrupt("return",{success:!0,processingResult:x});case 37:return e.prev=37,e.t0=e.catch(7),console.error("Error processing image ".concat(r,":"),e.t0),e.abrupt("return",{error:!0,processingResult:"Error: ".concat(e.t0.message||"Unable to process image.")});case 41:case"end":return e.stop()}},e,null,[[7,37]])}));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,n.A)(o().mark(function e(t){var r,n,a,s,i,c,l,d,p,f=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>1&&void 0!==f[1]?f[1]:"audio file",n=f.length>2?f[2]:void 0,console.log("Processing audio: ".concat(r," using OpenAI gpt-4o-transcribe")),a=null==n?void 0:n.openai){e.next=7;break}return console.error("Error processing audio: OpenAI API key is required."),e.abrupt("return",{error:!0,processingResult:"OpenAI API key for audio processing is required."});case 7:return e.prev=7,(s=new FormData).append("file",t),s.append("model","gpt-4o-transcribe"),i={Authorization:"Bearer ".concat(a)},e.next=15,fetch("https://api.openai.com/v1/audio/transcriptions",{method:"POST",headers:i,body:s});case 15:if((c=e.sent).ok){e.next=24;break}return e.next=19,c.json().catch(function(){return{}});case 19:if(d=e.sent,console.error("OpenAI API Error (".concat(c.status,"):"),d),401!==c.status){e.next=23;break}throw Error("OpenAI API key is invalid or unauthorized (401)");case 23:throw Error("OpenAI API request failed with status ".concat(c.status,": ").concat((null==(l=d.error)?void 0:l.message)||c.statusText));case 24:return e.next=26,c.json();case 26:return p=e.sent.text||"No transcription result from API",e.next=30,(0,u.ys)({type:"audio",source:r,content:"Audio file: ".concat(t.name),processingResult:p,timestamp:new Date().toISOString()});case 30:return console.log("Audio processed successfully: ".concat(r)),e.abrupt("return",{success:!0,processingResult:p});case 34:return e.prev=34,e.t0=e.catch(7),console.error("Error processing audio ".concat(r,":"),e.t0),e.abrupt("return",{error:!0,processingResult:"Error: ".concat(e.t0.message||"Unable to process audio.")});case 38:case"end":return e.stop()}},e,null,[[7,34]])}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,n.A)(o().mark(function e(t){var r,n,a,s,i,c,l,m,g,h,v,y,b,A,k,w,j,I,P,E,S,C,O,R,_,F,D,T,z,K,W,U,N,V,q,L,B,Y,H,G,M,X=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=X.length>1&&void 0!==X[1]?X[1]:"video file",n=X.length>2?X[2]:void 0,console.log("Processing video: ".concat(r)),a=null==n?void 0:n.openai,s=null==n?void 0:n.openrouter,i="Audio transcription requires an OpenAI API key.",c="Frame analysis requires an OpenRouter API key and ffmpeg integration.",l="",m=!1,g=!1,!a){e.next=43;break}return e.prev=11,console.log("Starting audio transcription for video: ".concat(r," using OpenAI gpt-4o-transcribe")),(h=new FormData).append("file",t),h.append("model","gpt-4o-transcribe"),v={Authorization:"Bearer ".concat(a)},e.next=20,fetch("https://api.openai.com/v1/audio/transcriptions",{method:"POST",headers:v,body:h});case 20:if((y=e.sent).ok){e.next=29;break}return e.next=24,y.json().catch(function(){return{}});case 24:if(A=e.sent,console.error("OpenAI Whisper API Error (".concat(y.status,"):"),A),401!==y.status){e.next=28;break}throw Error("OpenAI API key is invalid or unauthorized (401)");case 28:throw Error("OpenAI Whisper API request failed with status ".concat(y.status,": ").concat((null==(b=A.error)?void 0:b.message)||y.statusText));case 29:return e.next=31,y.json();case 31:i=e.sent.text||"No transcription result from OpenAI API.",m=!0,console.log("Audio transcription successful for video: ".concat(r)),e.next=41;break;case 37:e.prev=37,e.t0=e.catch(11),console.error("Error during video audio transcription for ".concat(r,":"),e.t0),i="Audio transcription error: ".concat(e.t0.message);case 41:e.next=44;break;case 43:console.warn("Skipping audio transcription for ".concat(r,": OpenAI API key not provided."));case 44:if(!s){e.next=191;break}return k=new d.m,w=(0,f.A)().substring(0,8),j="".concat(w,"_input.mp4"),I="".concat(w,"_frame-%03d.jpg"),e.prev=49,console.log("Loading ffmpeg-core. This might take a while..."),P="https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd",E="".concat(P,"/ffmpeg-core.js"),S="".concat(P,"/ffmpeg-core.wasm"),e.next=56,k.load({coreURL:E,wasmURL:S});case 56:return console.log("FFmpeg loaded. Writing video file to virtual FS..."),e.t1=k,e.t2=j,e.next=61,(0,p.t2)(t);case 61:return e.t3=e.sent,e.next=64,e.t1.writeFile.call(e.t1,e.t2,e.t3);case 64:return console.log("Extracting keyframes (1 frame per 5 seconds)..."),e.next=67,k.exec(["-i",j,"-vf","fps=1/5",I]);case 67:return console.log("Keyframes extracted."),console.log("Reading extracted frames..."),e.next=71,k.listDir(".");case 71:C=e.sent,O=[],R=x(C),e.prev=74,F=o().mark(function e(){var t,r,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=_.value).name.startsWith("".concat(w,"_frame-"))&&t.name.endsWith(".jpg"))){e.next=12;break}return e.next=4,k.readFile(t.name);case 4:return r=new Blob([e.sent],{type:"image/jpeg"}),e.next=8,new Promise(function(e,t){var n=new FileReader;n.onload=function(){var t;return e(null==(t=n.result)?void 0:t.toString().split(",")[1])},n.onerror=function(e){return t(e)},n.readAsDataURL(r)});case 8:return(n=e.sent)&&O.push({name:t.name,base64:n}),e.next=12,k.deleteFile(t.name);case 12:case"end":return e.stop()}},e)}),R.s();case 77:if((_=R.n()).done){e.next=81;break}return e.delegateYield(F(),"t4",79);case 79:e.next=77;break;case 81:e.next=86;break;case 83:e.prev=83,e.t5=e.catch(74),R.e(e.t5);case 86:return e.prev=86,R.f(),e.finish(86);case 89:return e.next=91,k.deleteFile(j);case 91:if(console.log("Read ".concat(O.length," frames.")),!(O.length>0)){e.next=143;break}console.log("Analyzing frames with OpenRouter Gemini Flash..."),D="",T="https://openrouter.ai/api/v1/chat/completions",z={Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},K=O.slice(0,5),console.log("Sending ".concat(K.length," frames for analysis...")),W=x(K),e.prev=100,W.s();case 102:if((U=W.n()).done){e.next=130;break}return N=U.value,e.prev=104,V=JSON.stringify({model:"google/gemini-2.0-flash-thinking-exp:free",messages:[{role:"user",content:[{type:"text",text:"Extract any text visible in this image. If no text is present, respond with 'No text found'."},{type:"image_url",image_url:{url:"data:image/jpeg;base64,".concat(N.base64)}}]}],max_tokens:200}),e.next=108,fetch(T,{method:"POST",headers:z,body:V});case 108:if(!(q=e.sent).ok){e.next=117;break}return e.next=112,q.json();case 112:"no text found"!==(B=(null==(L=e.sent.choices[0])||null==(L=L.message)?void 0:L.content)||"Error analyzing frame").toLowerCase().trim()&&(D+="[".concat(N.name.replace(w+"_",""),"]: ").concat(B,"\n")),e.next=122;break;case 117:return e.next=119,q.json().catch(function(){return{}});case 119:Y=e.sent,console.error("Error analyzing frame ".concat(N.name,": Status ").concat(q.status),Y),D+="[".concat(N.name.replace(w+"_",""),"]: Error ").concat(q.status,"\n");case 122:e.next=128;break;case 124:e.prev=124,e.t6=e.catch(104),console.error("Error during vision API call for frame ".concat(N.name,":"),e.t6),D+="[".concat(N.name.replace(w+"_",""),"]: API Call Failed\n");case 128:e.next=102;break;case 130:e.next=135;break;case 132:e.prev=132,e.t7=e.catch(100),W.e(e.t7);case 135:return e.prev=135,W.f(),e.finish(135);case 138:c=D.trim()||"No text found in analyzed frames.",g=!0,console.log("Frame analysis finished."),e.next=144;break;case 143:c="No frames were extracted from the video.";case 144:e.next=177;break;case 146:return e.prev=146,e.t8=e.catch(49),console.error("Error during ffmpeg processing:",e.t8),c="Frame analysis failed: ".concat(e.t8.message),e.prev=150,e.next=153,k.listDir(".");case 153:H=x(e.sent),e.prev=155,H.s();case 157:if((G=H.n()).done){e.next=164;break}if(!(M=G.value).name.startsWith(w)){e.next=162;break}return e.next=162,k.deleteFile(M.name);case 162:e.next=157;break;case 164:e.next=169;break;case 166:e.prev=166,e.t9=e.catch(155),H.e(e.t9);case 169:return e.prev=169,H.f(),e.finish(169);case 172:e.next=177;break;case 174:e.prev=174,e.t10=e.catch(150),console.error("Error during ffmpeg cleanup:",e.t10);case 177:if(e.prev=177,!k.loaded){e.next=188;break}return e.prev=179,e.next=182,k.terminate();case 182:console.log("FFmpeg terminated."),e.next=188;break;case 185:e.prev=185,e.t11=e.catch(179),console.error("Error terminating ffmpeg:",e.t11);case 188:return e.finish(177);case 189:e.next=193;break;case 191:console.warn("Skipping frame analysis for ".concat(r,": OpenRouter API key not provided.")),c="Frame analysis/OCR requires an OpenRouter API key.";case 193:return l="--- Audio Transcription ---\n".concat(i,"\n\n--- On-Screen Text (OCR) ---\n").concat(c),e.prev=194,e.next=197,(0,u.ys)({type:"video",source:r,content:"Video file: ".concat(t.name),processingResult:l,timestamp:new Date().toISOString()});case 197:return console.log("Video processing finished for: ".concat(r)),e.abrupt("return",{success:(m||!a)&&(g||!s),processingResult:l});case 201:return e.prev=201,e.t12=e.catch(194),console.error("Failed to save video processing results to DB for ".concat(r,":"),e.t12),e.abrupt("return",{error:!0,processingResult:"Failed to save results to database. ".concat(l)});case 205:case"end":return e.stop()}},e,null,[[11,37],[49,146,177,189],[74,83,86,89],[100,132,135,138],[104,124],[150,174],[155,166,169,172],[179,185],[194,201]])}));return function(t){return e.apply(this,arguments)}}(),b=r(86256),A=r(26778),k=r(37214),w=r(25290),j=r(45317),I=r(4306),P=r(75801),E=r(34955),S=r(87434),C=r(37876),O=r(65364);let R=function(e){var t=e.onKeysSaved,r=e.initialKeys,n=void 0===r?{openai:""}:r,a=(0,s.useState)(""),o=a[0],i=a[1],c=(0,s.useState)(""),u=c[0],d=c[1],p=(0,s.useState)(""),f=p[0],x=p[1],m=(0,s.useState)(!1),g=m[0],h=m[1];return(0,s.useEffect)(function(){h(!!O.env.NEXT_PUBLIC_OPENROUTER_API_KEY),i((n.openai?n:(0,l.getApiKeys)()).openai||"")},[n]),(0,C.jsxs)(k.A,{component:"form",noValidate:!0,autoComplete:"off",sx:{mt:1,mb:3,p:2,border:"1px solid",borderColor:"divider",borderRadius:1},children:[(0,C.jsx)(A.A,{variant:"h6",gutterBottom:!0,children:"Configure API Keys"}),(0,C.jsxs)(I.A,{severity:"info",sx:{mb:2},children:["Enter your OpenAI API key below. Keys are stored locally in your browser's localStorage and only sent to OpenAI.",g?" A default OpenRouter API key is configured in this build and will be used for accessing various other models.":" An OpenRouter key is not configured in this build, so only OpenAI models will be available.",(0,C.jsx)("br",{}),(0,C.jsx)("br",{}),(0,C.jsx)("strong",{children:"How to get an OpenAI API Key:"}),(0,C.jsx)("ul",{children:(0,C.jsxs)("li",{children:["Visit"," ",(0,C.jsx)(S.A,{href:"https://platform.openai.com/settings/organization/api-keys",target:"_blank",rel:"noopener noreferrer",children:"platform.openai.com/settings/organization/api-keys"}),", sign in, and create a new secret key."]})}),(0,C.jsx)("br",{}),(0,C.jsx)("strong",{children:"Security Reminder:"})," Your OpenAI key is stored in your browser's local storage. ",g&&"The default OpenRouter key is embedded in the application code."]}),u&&(0,C.jsx)(I.A,{severity:"error",sx:{mb:2},children:u}),f&&(0,C.jsx)(I.A,{severity:"success",sx:{mb:2},children:f}),(0,C.jsx)(E.A,{label:"OpenAI API Key",variant:"outlined",fullWidth:!0,margin:"normal",type:"password",value:o,onChange:function(e){return i(e.target.value)},helperText:g?"Optional. If provided, allows access to OpenAI models.":"Required for processing."}),(0,C.jsx)(w.A,{variant:"contained",onClick:function(){if(d(""),x(""),!o&&!g)return void d("Please provide an OpenAI API key. A default OpenRouter key is not available in this build.");try{o?localStorage.setItem("openai_api_key",o):localStorage.removeItem("openai_api_key"),window.__PRECEK_API_KEYS=window.__PRECEK_API_KEYS||{},window.__PRECEK_API_KEYS.openai=o||"",x("OpenAI API key saved successfully!"),t&&t(),setTimeout(function(){return x("")},3e3)}catch(e){console.error("Error saving API keys:",e),d("Failed to save API keys. Check browser permissions for localStorage.")}},sx:{mt:2},disabled:!o&&!g,children:"Save Key "})]})};var _=r(14578),F=r(92882),D=r(85325),T=r(83664),z=r(76881),K=r(25638),W=r(25225),U=r(42280),N=r(32617);let V=function(e){var t=e.onProcessText,r=e.onProcessTextFile,n=e.onProcessImage,a=e.onProcessAudio,o=e.onProcessVideo,i=e.isProcessing,c=e.keysConfigured,l=e.openaiApiKey,u=(0,s.useState)(""),d=u[0],p=u[1],f=function(e,t,n){var a=document.createElement("input");a.type="file",a.accept=e,a.multiple=t,a.onchange=function(e){var t=e.target.files;t&&t.length>0&&(n===r?n(t):n(t[0])),e.target.value=null},a.click()};return(0,C.jsxs)(_.A,{variant:"outlined",sx:{mb:3},children:[(0,C.jsx)(D.A,{title:(0,C.jsx)(A.A,{variant:"h5",children:"Process Content"}),subheader:(0,C.jsx)(A.A,{color:"text.secondary",children:"Input text or upload files for AI processing"})}),(0,C.jsx)(F.A,{children:(0,C.jsxs)(k.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,C.jsxs)(k.A,{children:[(0,C.jsx)(A.A,{variant:"subtitle2",sx:{mb:1},children:"Text Input"}),(0,C.jsxs)(k.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,C.jsx)(E.A,{id:"text-input",fullWidth:!0,multiline:!0,minRows:4,maxRows:12,value:d,onChange:function(e){return p(e.target.value)},placeholder:"Enter text to process",variant:"outlined",disabled:i||!c,sx:{"& .MuiOutlinedInput-root":{padding:"12px",fontFamily:"inherit"}}}),(0,C.jsx)(w.A,{variant:"contained",onClick:function(){if(!d)return void alert("Please enter text to process");t(d)},disabled:i||!c||!d.trim(),startIcon:(0,C.jsx)(N.A,{}),sx:{alignSelf:"flex-end"},title:c?"":"API keys required",children:"Process Text"})]})]}),(0,C.jsx)(T.A,{sx:{my:1}}),(0,C.jsxs)(k.A,{children:[(0,C.jsx)(A.A,{variant:"subtitle2",sx:{mb:1},children:"Upload Files"}),(0,C.jsxs)(k.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[(0,C.jsx)(w.A,{variant:"outlined",component:"span",disabled:i||!c,startIcon:(0,C.jsx)(z.A,{}),onClick:function(){return f(".txt,.pdf",!0,r)},title:c?"":"API keys required",children:"Upload Text File (.txt, .pdf)"}),(0,C.jsx)(w.A,{onClick:function(){return f("image/*",!1,n)},variant:"outlined",disabled:i||!c,startIcon:(0,C.jsx)(U.A,{}),title:c?"":"API keys required",children:"Process Image"}),(0,C.jsx)(w.A,{onClick:function(){return f("audio/*",!1,a)},variant:"outlined",disabled:i||!c||!l,startIcon:(0,C.jsx)(K.A,{}),title:c?l?"":"OpenAI API key required for audio processing":"API keys required",children:"Process Audio"}),(0,C.jsx)(w.A,{onClick:function(){return f("video/*",!1,o)},variant:"outlined",disabled:i||!c||!l,startIcon:(0,C.jsx)(W.A,{}),title:c?l?"":"OpenAI API key required for video processing":"API keys required",children:"Process Video"})]})]})]})})]})};var q=r(46058),L=r(19810),B=r(62712);let Y=function(e){var t=e.processedData,r=e.onExportToCSV,n=e.onClearData,a=e.onDeleteItem,o=e.isProcessing;return t&&0!==t.length?(0,C.jsxs)(_.A,{children:[(0,C.jsx)(D.A,{title:(0,C.jsx)(A.A,{variant:"h6",children:"Processed Data"}),subheader:(0,C.jsxs)(A.A,{variant:"body2",color:"text.secondary",children:["Recent results (",t.length," total items)"]}),action:(0,C.jsxs)(k.A,{sx:{display:"flex",gap:1,alignItems:"center",mt:{xs:1,sm:0}},children:[(0,C.jsx)(w.A,{onClick:r,variant:"contained",color:"secondary",size:"small",disabled:o||0===t.length,children:"Export All to CSV"}),(0,C.jsx)(w.A,{onClick:n,variant:"contained",color:"error",size:"small",disabled:o||0===t.length,children:"Clear All Data"})]}),sx:{flexDirection:{xs:"column",sm:"row"},alignItems:{sm:"center"}}}),(0,C.jsxs)(F.A,{children:[(0,C.jsx)(q.Ay,{container:!0,spacing:2,children:t.slice(0,6).map(function(e){return(0,C.jsxs)(q.Ay,{item:!0,xs:12,sm:6,md:4,children:[" ",(0,C.jsxs)(_.A,{sx:{overflow:"hidden",height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[" ",a&&(0,C.jsx)(P.A,{title:"Delete this item",children:(0,C.jsx)(L.A,{"aria-label":"delete item",onClick:function(){return a(e.id)},size:"small",sx:{position:"absolute",top:8,right:8,zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.7)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)"}},disabled:o,children:(0,C.jsx)(B.A,{fontSize:"small"})})}),"image"===e.type&&e.data&&(0,C.jsx)(k.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:100,overflow:"hidden",mb:1,border:function(e){return"1px solid ".concat(e.palette.divider)},borderRadius:1},children:(0,C.jsx)(k.A,{component:"img",src:e.data,alt:"Processed image: ".concat(e.name||"unnamed"),sx:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"}})}),"audio"===e.type&&e.data&&(0,C.jsx)(k.A,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"center",height:"10rem"},children:(0,C.jsx)(k.A,{component:"audio",controls:!0,src:e.data,sx:{width:"100%"}})}),"video"===e.type&&e.data&&(0,C.jsx)(k.A,{sx:{height:"10rem",bgcolor:"black",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:(0,C.jsx)(k.A,{component:"video",controls:!0,src:e.data,sx:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"}})}),"image"!==e.type&&"audio"!==e.type&&"video"!==e.type&&(0,C.jsx)(k.A,{sx:{height:"10rem",bgcolor:"action.hover",display:"flex",alignItems:"center",justifyContent:"center",p:2},children:(0,C.jsx)(A.A,{variant:"caption",color:"text.secondary",children:"No preview available"})}),(0,C.jsxs)(F.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,C.jsxs)(k.A,{children:[(0,C.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,C.jsx)(k.A,{sx:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",bgcolor:(0,l.getTypeColorMui)(e.type)}}),(0,C.jsx)(A.A,{variant:"body2",fontWeight:"medium",children:e.originalName?(0,l.truncateText)(e.originalName,25):e.type.toUpperCase()}),(0,C.jsxs)(A.A,{variant:"caption",color:"text.secondary",sx:{ml:"auto",whiteSpace:"nowrap"},children:[new Date(e.timestamp).toLocaleDateString()," "]})]}),("text"===e.type||e.processingResult)&&(0,C.jsx)(A.A,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",mb:2},children:"text"===e.type?(0,l.truncateText)(e.content||"",100):(0,l.truncateText)(e.processingResult||"",100)})]}),("text"===e.type||e.processingResult)&&(0,C.jsx)(k.A,{sx:{mt:"auto",display:"flex",justifyContent:"flex-end"},children:(0,C.jsx)(c(),{href:"/readtext?id=".concat(e.id),passHref:!0,style:{textDecoration:"none"},children:(0,C.jsx)(w.A,{size:"small",variant:"text",children:"View Details"})})})]})]})]},e.id)})}),t.length>6&&(0,C.jsx)(k.A,{sx:{mt:3,textAlign:"center"},children:(0,C.jsx)(c(),{href:"/visualization",style:{textDecoration:"none"},children:(0,C.jsxs)(A.A,{color:"primary",sx:{"&:hover":{textDecoration:"underline"},cursor:"pointer"},children:["View all ",t.length," items in visualizations →"]})})})]})]}):null};function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}let G=function(){var e,t,r,a,i,d=(0,s.useState)([]),p=d[0],f=d[1],x=(0,s.useState)(!1),m=x[0],E=x[1],S=(0,s.useState)(""),O=S[0],_=S[1],F=(0,s.useState)(""),D=F[0],T=F[1],z=(0,s.useState)(!1),K=z[0],W=z[1],U=(0,s.useState)({openai:"",openrouter:""}),N=U[0],q=U[1],L=(0,s.useState)(!1),B=L[0],G=L[1];(0,s.useEffect)(function(){var e=(0,l.getApiKeys)(),t=!!(e.openai||e.openrouter);q(e),G(t),W(!t)},[]),(0,s.useEffect)(function(){var e;(e=(0,n.A)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.WP)();case 3:f(e.sent||[]),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching data from IndexedDB:",e.t0),_("Failed to load existing data.");case 11:case"end":return e.stop()}},e,null,[[0,7]])})),function(){return e.apply(this,arguments)})()},[]),(0,s.useEffect)(function(){if(D||O){var e=setTimeout(function(){T(""),_("")},5e3);return function(){return clearTimeout(e)}}},[D,O]);var M=(e=(0,n.A)(o().mark(function e(t,r,n){var a,s,i=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>3&&void 0!==i[3]?i[3]:null,E(!0),_(""),T(""),e.prev=4,e.next=7,t(r,n,N);case 7:if(!((s=e.sent)&&s.error)){e.next=10;break}throw Error(s.processingResult||"Processing failed");case 10:return T("Successfully processed: ".concat(a||r)),e.next=13,(0,u.WP)();case 13:f(e.sent||[]),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),console.error("Error processing ".concat(a||r,":"),e.t0),e.t0.message.includes("API key is invalid")||e.t0.message.includes("unauthorized")||e.t0.message.includes("401")?(_("Authentication failed: An API key might be invalid or expired. Please check your configuration."),G(!1),W(!0)):_("Failed to process ".concat(a||r,": ").concat(e.t0.message||"Unknown error"));case 21:return e.prev=21,E(!1),e.finish(21);case 24:case"end":return e.stop()}},e,null,[[4,17,21,24]])})),function(t,r,n){return e.apply(this,arguments)}),X=(t=(0,n.A)(o().mark(function e(t){var r,n,a,s,i,c,d,p,x,m,h,v,y,b;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:E(!0),_(""),T(""),r=0,n=0,a=Array.from(t).map(function(e){return e.name}).join(", "),s=null,i=!1,c=function(e,t){return e.length<=t?e:e.substring(0,t)+"..."},d=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return H(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,t)}}(e))){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw o}}}}(t),e.prev=10,d.s();case 12:if((p=d.n()).done){e.next=52;break}if(x=p.value,e.prev=14,m="",!(h=x.name.toLowerCase()).endsWith(".txt")){e.next=23;break}return e.next=20,(0,l.readTextFile)(x);case 20:case 26:m=e.sent,e.next=31;break;case 23:if(!h.endsWith(".pdf")){e.next=29;break}return e.next=26,(0,l.readPdfFile)(x);case 29:return console.warn("Skipping unsupported file type: ".concat(x.name)),e.abrupt("continue",50);case 31:if(!(!m||0===m.trim().length)){e.next=34;break}return console.warn("Skipping empty or unreadable file: ".concat(x.name)),e.abrupt("continue",50);case 34:return e.next=36,g(m,x.name,N);case 36:if(!((v=e.sent)&&v.error)){e.next=39;break}throw Error(v.processingResult||"Processing failed for ".concat(x.name));case 39:r++,i=!0,e.next=50;break;case 43:if(e.prev=43,e.t0=e.catch(14),console.error("Error processing file ".concat(x.name,":"),e.t0),n++,s||(s=e.t0),!(e.t0.message.includes("API key is invalid")||e.t0.message.includes("unauthorized")||e.t0.message.includes("401"))){e.next=50;break}return e.abrupt("break",52);case 50:e.next=12;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(10),d.e(e.t1);case 57:return e.prev=57,d.f(),e.finish(57);case 60:if(s&&(s.message.includes("API key is invalid")||s.message.includes("unauthorized")||s.message.includes("401"))?(_("Authentication failed: An API key might be invalid or expired. Please check your configuration."),G(!1),W(!0)):r>0&&0===n?T("Successfully processed ".concat(r," file(s): ").concat(c(a,50))):r>0&&n>0?(T("Processed ".concat(r," file(s) with ").concat(n," error(s).")),_("Failed to process ".concat(n," file(s). Check console for details. First error: ").concat((null==(y=s)?void 0:y.message)||"Unknown"))):n>0?_("Failed to process ".concat(n," file(s). First error: ").concat((null==(b=s)?void 0:b.message)||"Unknown")):0===r&&0===n&&T("No supported files found or processed."),!(i||n>0)){e.next=73;break}return e.prev=62,e.next=65,(0,u.WP)();case 65:f(e.sent||[]),e.next=73;break;case 69:e.prev=69,e.t2=e.catch(62),console.error("Error fetching updated data after processing files:",e.t2),_(function(e){return e?"".concat(e," | Failed to refresh data list."):"Failed to refresh data list."});case 73:E(!1);case 74:case"end":return e.stop()}},e,null,[[10,54,57,60],[14,43],[62,69]])})),function(e){return t.apply(this,arguments)}),$=(r=(0,n.A)(o().mark(function e(){var t,r,n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,u.GF)();case 3:t=new Blob([e.sent],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(t),(n=document.createElement("a")).href=r,n.download="precek_data.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),T("Data exported to CSV successfully"),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Error exporting to CSV:",e.t0),_("Failed to export data to CSV");case 20:case"end":return e.stop()}},e,null,[[0,16]])})),function(){return r.apply(this,arguments)}),J=(a=(0,n.A)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to clear ALL processed data? This cannot be undone.")){e.next=13;break}return e.prev=1,e.next=4,(0,u.Bq)();case 4:f([]),T("All data has been cleared"),_(""),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("Error clearing data:",e.t0),_("Failed to clear data");case 13:case"end":return e.stop()}},e,null,[[1,9]])})),function(){return a.apply(this,arguments)}),Q=(i=(0,n.A)(o().mark(function e(t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete item ID: ".concat(t,"?"))){e.next=21;break}return E(!0),_(""),T(""),e.prev=4,e.next=7,(0,u.Wv)(t);case 7:return e.next=9,(0,u.WP)();case 9:f(e.sent||[]),T("Item ID: ".concat(t," deleted successfully.")),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),console.error("Error deleting item ID: ".concat(t),e.t0),_("Failed to delete item ID: ".concat(t,". ").concat(e.t0.message||""));case 18:return e.prev=18,E(!1),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[4,14,18,21]])})),function(e){return i.apply(this,arguments)});return(0,C.jsxs)(b.A,{maxWidth:"lg",sx:{py:4,px:{xs:1,sm:2}},children:[" ",(0,C.jsxs)(k.A,{component:"header",sx:{mb:4,textAlign:"center"},children:[" ",(0,C.jsx)(A.A,{variant:"h3",component:"h1",sx:{fontWeight:"bold"},children:"Precek"}),(0,C.jsx)(A.A,{variant:"body1",color:"text.secondary",children:"Your text, image, audio and video as a Data"})]}),(0,C.jsxs)(k.A,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1},children:[p.length>0?(0,C.jsx)(c(),{href:"/visualization",passHref:!0,style:{textDecoration:"none"},children:(0,C.jsx)(w.A,{variant:"contained",color:"primary",size:"medium",sx:{borderRadius:2,boxShadow:1},children:"View Data Visualizations"})}):(0,C.jsx)(P.A,{title:"Process some data first to enable visualizations",children:(0,C.jsx)("span",{children:(0,C.jsx)(w.A,{variant:"contained",color:"primary",size:"medium",disabled:!0,sx:{borderRadius:2,boxShadow:1},children:"View Data Visualizations"})})}),B&&(0,C.jsx)(w.A,{variant:"outlined",size:"small",onClick:function(){W(function(e){return!e})},sx:{borderRadius:2},children:K?"Hide API Key Form":"Change API Keys"})]}),K&&(0,C.jsx)(R,{onKeysSaved:function(){var e=(0,l.getApiKeys)();q(e),G(!!(e.openai||e.openrouter)),W(!1),T("API keys saved successfully!")},initialKeys:{openai:N.openai,openrouter:N.openrouter}}),(0,C.jsx)(V,{onProcessText:function(e){return M(g,e,"text")},onProcessTextFile:X,onProcessImage:function(e){return M(h,e,"image",e.name)},onProcessAudio:function(e){return M(v,e,"audio",e.name)},onProcessVideo:function(e){return M(y,e,"video",e.name)},isProcessing:m,keysConfigured:B,openaiApiKey:N.openai}),m&&(0,C.jsxs)(k.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",my:2,gap:1},children:[(0,C.jsx)(j.A,{size:20}),(0,C.jsx)(A.A,{variant:"body2",color:"text.secondary",children:"Processing..."})]}),O&&(0,C.jsx)(I.A,{severity:"error",sx:{mb:3},children:O}),D&&!m&&(0,C.jsx)(I.A,{severity:"success",sx:{mb:3},children:D}),(0,C.jsx)(Y,{processedData:p,onExportToCSV:$,onClearData:J,onDeleteItem:Q,isProcessing:m}),(0,C.jsxs)(k.A,{component:"footer",sx:{mt:6,pt:3,borderTop:1,borderColor:"divider",display:"flex",justifyContent:"center",gap:4},children:[(0,C.jsx)(c(),{href:"/about",passHref:!0,style:{textDecoration:"none"},children:(0,C.jsx)(w.A,{variant:"text",color:"primary",children:"About"})}),(0,C.jsx)(c(),{href:"/contributing",passHref:!0,style:{textDecoration:"none"},children:(0,C.jsx)(w.A,{variant:"text",color:"primary",children:"Contributing"})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[473,494,934,797,654,636,593,792],()=>t(42936)),_N_E=e.O()}]);