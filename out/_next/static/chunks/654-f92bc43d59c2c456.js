"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[654],{15654:(r,e,t)=>{t.d(e,{Bq:()=>w,GF:()=>j,WP:()=>v,Wv:()=>O,nu:()=>D,ys:()=>g});var n=t(70236),o=t(63857),a=t(43081),c=t.n(a);function s(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function u(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?s(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}var i=null,p="processedData",l="apiKeys";function f(){return(f=(0,o.A)(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(r,e){if(i)return void r(i);var t=indexedDB.open("PrecekDatabase",20);t.onupgradeneeded=function(r){var e=r.target.result;e.objectStoreNames.contains(p)||e.createObjectStore(p,{keyPath:"id",autoIncrement:!0}),e.objectStoreNames.contains(l)||e.createObjectStore(l,{keyPath:"id"})},t.onsuccess=function(e){(i=e.target.result).onerror=function(r){console.error("Database error:",r.target.errorCode),i=null},r(i)},t.onerror=function(r){var t;console.error("Failed to initialize database:",r.target.error),i=null,e(Error("Failed to initialize database: ".concat((null==(t=r.target.error)?void 0:t.message)||"Unknown error")))},t.onblocked=function(){console.warn("Database open request blocked, please close other tabs/connections."),e(Error("Database initialization blocked."))}}));case 1:case"end":return r.stop()}},r)}))).apply(this,arguments)}function d(){return(d=(0,o.A)(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i){r.next=11;break}return r.prev=1,r.next=4,function(){return f.apply(this,arguments)}();case 4:i=r.sent,r.next=11;break;case 7:throw r.prev=7,r.t0=r.catch(1),console.error("Error during getDb initialization:",r.t0),r.t0;case 11:return r.abrupt("return",i);case 12:case"end":return r.stop()}},r,null,[[1,7]])}))).apply(this,arguments)}function b(r,e,t){var n;return new Promise((n=(0,o.A)(c().mark(function n(o,a){var s,u;return c().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){return d.apply(this,arguments)}();case 3:if(s=n.sent){n.next=7;break}return a(Error("Database not available.")),n.abrupt("return");case 7:t((u=s.transaction(r,e)).objectStore(r),o,a),u.oncomplete=function(){},u.onerror=function(e){console.error("Transaction error on ".concat(r,":"),e.target.error),a(e.target.error)},n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),console.error("Error starting transaction on ".concat(r,":"),n.t0),a(n.t0);case 18:case"end":return n.stop()}},n,null,[[0,14]])})),function(r,e){return n.apply(this,arguments)}))}function g(r){return h.apply(this,arguments)}function h(){return(h=(0,o.A)(c().mark(function r(e){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",b(p,"readwrite",function(r,t,n){e.timestamp||(e.timestamp=new Date().toISOString());var o=r.add(e);o.onsuccess=function(r){console.log("Data added with ID: ".concat(r.target.result),e),t(r.target.result)},o.onerror=function(r){console.error("Error in addData request:",r.target.error),n(r.target.error)}}));case 1:case"end":return r.stop()}},r)}))).apply(this,arguments)}function v(){return y.apply(this,arguments)}function y(){return(y=(0,o.A)(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",b(p,"readonly",function(r,e,t){var n=r.getAll();n.onsuccess=function(r){var t=r.target.result;t.sort(function(r,e){return new Date(e.timestamp)-new Date(r.timestamp)}),console.log("Retrieved ".concat(t.length," items from database.")),e(t)},n.onerror=function(r){console.error("Error in getAllData request:",r.target.error),t(r.target.error)}}));case 1:case"end":return r.stop()}},r)}))).apply(this,arguments)}function w(){return m.apply(this,arguments)}function m(){return(m=(0,o.A)(c().mark(function r(){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",b(p,"readwrite",function(r,e,t){var n=r.clear();n.onsuccess=function(){console.log("Processed data store cleared."),e(!0)},n.onerror=function(r){console.error("Error in clearAllData request:",r.target.error),t(r.target.error)}}));case 1:case"end":return r.stop()}},r)}))).apply(this,arguments)}function D(r){return k.apply(this,arguments)}function k(){return(k=(0,o.A)(c().mark(function r(e){var t;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!isNaN(t=parseInt(e,10))){r.next=4;break}throw console.error("Invalid ID provided to getDataById: ".concat(e)),Error("Invalid ID format: ".concat(e));case 4:return r.abrupt("return",b(p,"readonly",function(r,e,n){var o=r.get(t);o.onsuccess=function(r){e(r.target.result)},o.onerror=function(r){console.error("Error in getDataById for ID ".concat(t,":"),r.target.error),n(r.target.error)}}));case 5:case"end":return r.stop()}},r)}))).apply(this,arguments)}function O(r){return x.apply(this,arguments)}function x(){return(x=(0,o.A)(c().mark(function r(e){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",b(p,"readwrite",function(r,t,n){var o=r.delete(e);o.onsuccess=function(){console.log("Data deleted with ID: ".concat(e)),t(!0)},o.onerror=function(r){console.error("Error in deleteData for ID ".concat(e,":"),r.target.error),n(r.target.error)}}));case 1:case"end":return r.stop()}},r)}))).apply(this,arguments)}function j(){return E.apply(this,arguments)}function E(){return(E=(0,o.A)(c().mark(function r(){var e,t,o,a,s,u;return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,v();case 3:if(t=(e=r.sent).length>0?e[0]:null){r.next=7;break}return r.abrupt("return","No data to export");case 7:return o=["id","inputName","timestamp","analysisType"],a=Object.keys(t).filter(function(r){return!o.includes(r)&&"processingResult"!==r}).sort(),u=(s=[].concat(o,(0,n.A)(a),["processingResult"])).join(",")+"\n",e.forEach(function(r){var e=s.map(function(e){var t=r[e];if(null==t)return"";if("object"==typeof t)try{t=JSON.stringify(t).replace(/"/g,'""')}catch(r){t="[Object]"}return'"'.concat(String(t).replace(/"/g,'""'),'"')});u+=e.join(",")+"\n"}),r.abrupt("return",u);case 15:return r.prev=15,r.t0=r.catch(0),console.error("Error exporting to CSV:",r.t0),r.abrupt("return","Error exporting data to CSV");case 19:case"end":return r.stop()}},r,null,[[0,15]])}))).apply(this,arguments)}}}]);